<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kabwe Central SDA Church Choir - Management System</title>
    
    <style>
        /* Your existing CSS remains unchanged */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* ... rest of your CSS ... */
    </style>
</head>
<body>
    <div class="container">
        <!-- Your existing HTML structure remains the same -->
        
        <div id="messageArea"></div>
    </div>
    
    <script>
        // ===== GOOGLE SHEETS INTEGRATION =====
        // Replace with your Google Sheets ID (from the URL of your published sheet)
        const SHEET_ID = '1elHJEJFPucr66Lvylb0u4XkaZT-tiyD4V7rl6aLhYhA';
        
        // Sheet names/tabs in your Google Sheet
        const SHEETS = {
            MEMBERS: 'Members',
            ATTENDANCE: 'Attendance',
            LEAVE: 'LeaveApplications',
            SETTINGS: 'Settings'
        };
        "code-header"> Place this code RIGHT AFTER your sample data
"code-comment">"code-comment">// ===== GOOGLE SHEETS INTEGRATION ===== 
    "code-comment">"code-comment">// Replace with your Google Sheets ID (from the URL of your published sheet) 
    "code-keyword">"code-keyword">const "code-variable">SHEET_ID = "code-string">'1elHJEJFPucr66Lvylb0u4XkaZT-tiyD4V7rl6aLhYhA'; 
        "code-comment">"code-comment">// Sheet names/tabs in your Google Sheet "code-keyword">
            "code-keyword">const "code-variable">SHEETS = { "code-variable">MEMBERS: "code-string">'Members', 
                                                           "code-variable">ATTENDANCE: "code-string">'Attendance', 
                                                           "code-variable">LEAVE: "code-string">'LeaveApplications', 
                                                           "code-variable">SETTINGS: "code-string">'Settings' }; 
        "code-comment">"code-comment">// Base URL "code-keyword">for Google Sheets API "code-keyword">
            "code-keyword">const "code-variable">SHEETS_API = "code-string">`https:"code-comment">
            //sheets.googleapis.com/v4/spreadsheets/"code-variable">${SHEET_ID}"code-string">/values/`; 
        "code-comment">"code-comment">// Public API key (restrict this in Google Cloud Console) "code-keyword">
            "code-keyword">const "code-variable">API_KEY = "code-string">'YOUR_GOOGLE_API_KEY'; 
        "code-comment">"code-comment">// Function to get data from Google Sheets "code-keyword">
            "code-keyword">async "code-keyword">function "code-">function">getSheetData("code-variable">sheetName, "code-variable">range = "code-string">'') { "code-keyword">"code-keyword">try { "code-keyword">"code-keyword">const "code-variable">response = "code-keyword">"code-keyword">await "code-">function">fetch("code-string">`"code-variable">${SHEETS_API}"code-variable">${sheetName}"code-variable">${range}"code-string">?key="code-variable">${API_KEY}"code-string">`); "code-keyword">"code-keyword">const "code-variable">data = "code-keyword">"code-keyword">await "code-variable">response."code-">function">json(); "code-keyword">"code-keyword">return "code-variable">data."code-variable">values || []; } "code-keyword">"code-keyword">catch ("code-variable">"code-function">error) { "code-">function">"code-function">console."code-">function">"code-function">error("code-string">'Error fetching data:', "code-variable">"code-function">error); "code-">function">showMessage("code-string">'Error loading data. Please check your connection.', "code-string">'error'); "code-keyword">"code-keyword">return []; } } "code-comment">"code-comment">// Function to append data to Google Sheets "code-keyword">"code-keyword">async "code-keyword">function "code-">function">appendToSheet("code-variable">sheetName, "code-variable">values) { "code-keyword">"code-keyword">try { "code-keyword">"code-keyword">const "code-variable">response = "code-keyword">"code-keyword">await "code-">function">fetch("code-string">`"code-variable">${SHEETS_API}"code-variable">${sheetName}"code-string">:append?valueInputOption=USER_ENTERED&key="code-variable">${API_KEY}"code-string">`, { "code-variable">method: "code-string">'POST', "code-variable">headers: { "code-string">'Content-Type': "code-string">'application/json' }, "code-variable">body: "code-">function">JSON."code-">function">stringify({ "code-variable">values: ["code-variable">values] }) }); "code-keyword">"code-keyword">const "code-variable">result = "code-keyword">"code-keyword">await "code-variable">response."code-">function">json(); "code-keyword">"code-keyword">return "code-variable">result; } "code-keyword">"code-keyword">catch ("code-variable">"code-function">error) { "code-">function">"code-function">console."code-">function">"code-function">error("code-string">'Error appending data:', "code-variable">"code-function">error); "code-">function">showMessage("code-string">'Error saving data. Please try again.', "code-string">'error'); "code-keyword">"code-keyword">return "code-keyword">null; } } "code-comment">"code-comment">// Function to update data in Google Sheets "code-keyword">"code-keyword">async "code-keyword">function "code-">function">updateSheet("code-variable">sheetName, "code-variable">range, "code-variable">values) { "code-keyword">"code-keyword">try { "code-keyword">"code-keyword">const "code-variable">response = "code-keyword">"code-keyword">await "code-">function">fetch("code-string">`"code-variable">${SHEETS_API}"code-variable">${sheetName}"code-string">!"code-variable">${range}"code-string">?valueInputOption=USER_ENTERED&key="code-variable">${API_KEY}"code-string">`, { "code-variable">method: "code-string">'PUT', "code-variable">headers: { "code-string">'Content-Type': "code-string">'application/json' }, "code-variable">body: "code-">function">JSON."code-">function">stringify({ "code-variable">values: ["code-variable">values] }) }); "code-keyword">"code-keyword">const "code-variable">result = "code-keyword">"code-keyword">await "code-variable">response."code-">function">json(); "code-keyword">"code-keyword">return "code-variable">result; } "code-keyword">"code-keyword">catch ("code-variable">"code-function">error) { "code-">function">"code-function">console."code-">function">"code-function">error("code-string">'Error updating data:', "code-variable">"code-function">error); "code-">function">showMessage("code-string">'Error updating data. Please try again.', "code-string">'error'); "code-keyword">"code-keyword">return "code-keyword">null; } } 
            "code-comment">"code-comment">// Replace the existing saveToGoogleSheets 
            "code-keyword">function with this implementation "code-keyword">"code-keyword">async "code-keyword">function "code-">function">saveToGoogleSheets("code-variable">sheetName, "code-variable">data) { "code-keyword">"code-keyword">try { "code-keyword">"code-keyword">let "code-variable">values = []; "code-keyword">"code-keyword">switch("code-variable">sheetName) { "code-keyword">"code-keyword">case "code-string">'members': "code-variable">values = [ "code-variable">data."code-variable">id, "code-variable">data."code-variable">name, "code-variable">data."code-variable">phone, "code-variable">data."code-variable">voicePart, "code-variable">data."code-variable">email || "code-string">'', "code-variable">data."code-variable">registeredDate, "code-variable">data."code-variable">status ]; "code-keyword">"code-keyword">await "code-">function">appendToSheet("code-variable">SHEETS."code-variable">MEMBERS, "code-variable">values); "code-keyword">"code-keyword">break; "code-keyword">"code-keyword">case "code-string">'attendance': "code-variable">values = [ "code-variable">data."code-variable">id, "code-variable">data."code-variable">memberId, "code-variable">data."code-variable">memberName, "code-variable">data."code-variable">date, "code-variable">data."code-variable">serviceType, "code-variable">data."code-variable">status, "code-variable">data."code-variable">timestamp ]; "code-keyword">"code-keyword">await "code-">function">appendToSheet("code-variable">SHEETS."code-variable">ATTENDANCE, "code-variable">values); "code-keyword">"code-keyword">break; "code-keyword">"code-keyword">case "code-string">'leave_applications': "code-variable">values = [ "code-variable">data."code-variable">id, "code-variable">data."code-variable">memberId, "code-variable">data."code-variable">memberName, "code-variable">data."code-variable">startDate, "code-variable">data."code-variable">endDate, "code-variable">data."code-variable">leaveType, "code-variable">data."code-variable">reason, "code-variable">data."code-variable">status, "code-variable">data."code-variable">applicationDate, "code-variable">data."code-variable">adminComments || "code-string">'', "code-variable">data."code-variable">reviewedBy || "code-string">'', "code-variable">data."code-variable">reviewDate || "code-string">'' ]; "code-keyword">"code-keyword">await "code-">function">appendToSheet("code-variable">SHEETS."code-variable">LEAVE, "code-variable">values); "code-keyword">"code-keyword">break; } "code-comment">"code-comment">// Also save to local storage as backup "code-">function">saveToLocalStorage(); } "code-keyword">"code-keyword">catch ("code-variable">"code-function">error) { "code-">function">"code-function">console."code-">function">"code-function">error("code-string">'Error saving to Google Sheets:', "code-variable">"code-function">error); "code-">function">showMessage("code-string">'Could not save to cloud. Using local storage.', "code-string">'warning'); "code-">function">saveToLocalStorage(); } } "code-comment">"code-comment">// Local storage fallback functions "code-keyword">"code-keyword">function "code-">function">saveToLocalStorage() { "code-">function">localStorage."code-">function">setItem("code-string">'choirMembers', "code-">function">JSON."code-">function">stringify("code-variable">members)); "code-">function">localStorage."code-">function">setItem("code-string">'choirAttendance', "code-">function">JSON."code-">function">stringify("code-variable">attendance)); "code-">function">localStorage."code-">function">setItem("code-string">'choirLeaveApplications', "code-">function">JSON."code-">function">stringify("code-variable">leaveApplications)); "code-">function">localStorage."code-">function">setItem("code-string">'choirSettings', "code-">function">JSON."code-">function">stringify("code-variable">settings)); "code-">function">localStorage."code-">function">setItem("code-string">'choirNextIds', "code-">function">JSON."code-">function">stringify({ "code-variable">nextMemberId, "code-variable">nextAttendanceId, "code-variable">nextLeaveId })); } "code-keyword">"code-keyword">function "code-">function">loadFromLocalStorage() { "code-keyword">"code-keyword">const "code-variable">savedMembers = "code-">function">localStorage."code-">function">getItem("code-string">'choirMembers'); "code-keyword">"code-keyword">const "code-variable">savedAttendance = "code-">function">localStorage."code-">function">getItem("code-string">'choirAttendance'); "code-keyword">"code-keyword">const "code-variable">savedLeave = "code-">function">localStorage."code-">function">getItem("code-string">'choirLeaveApplications'); "code-keyword">"code-keyword">const "code-variable">savedSettings = "code-">function">localStorage."code-">function">getItem("code-string">'choirSettings'); "code-keyword">"code-keyword">const "code-variable">savedIds = "code-">function">localStorage."code-">function">getItem("code-string">'choirNextIds'); "code-keyword">"code-keyword">if ("code-variable">savedMembers) "code-variable">members = "code-">function">JSON."code-">function">parse("code-variable">savedMembers); "code-keyword">"code-keyword">if ("code-variable">savedAttendance) "code-variable">attendance = "code-">function">JSON."code-">function">parse("code-variable">savedAttendance); "code-keyword">"code-keyword">if ("code-variable">savedLeave) "code-variable">leaveApplications = "code-">function">JSON."code-">function">parse("code-variable">savedLeave); "code-keyword">"code-keyword">if ("code-variable">savedSettings) "code-variable">settings = "code-">function">JSON."code-">function">parse("code-variable">savedSettings); "code-keyword">"code-keyword">if ("code-variable">savedIds) { "code-keyword">"code-keyword">const "code-variable">ids = "code-">function">JSON."code-">function">parse("code-variable">savedIds); "code-variable">nextMemberId = "code-variable">ids."code-variable">nextMemberId; "code-variable">nextAttendanceId = "code-variable">ids."code-variable">nextAttendanceId; "code-variable">nextLeaveId = "code-variable">ids."code-variable">nextLeaveId; } } "code-comment">"code-comment">// Initialize data from Google Sheets "code-keyword">"code-keyword">async "code-keyword">function "code-">function">initializeData() { "code-keyword">"code-keyword">try { "code-comment">"code-comment">// Load members "code-keyword">"code-keyword">const "code-variable">membersData = "code-keyword">"code-keyword">await "code-">function">getSheetData("code-variable">SHEETS."code-variable">MEMBERS); "code-keyword">"code-keyword">if ("code-variable">membersData."code-variable">length > 1) { "code-variable">members = "code-variable">membersData."code-">function">slice(1)."code-">function">map("code-variable">row => ({ "code-variable">id: "code-">function">parseInt("code-variable">row[0]), "code-variable">name: "code-variable">row[1], "code-variable">phone: "code-variable">row[2], "code-variable">voicePart: "code-variable">row[3], "code-variable">email: "code-variable">row[4], "code-variable">registeredDate: "code-variable">row[5], "code-variable">status: "code-variable">row[6] })); "code-variable">nextMemberId = "code-">function">Math."code-">function">max(..."code-variable">members."code-">function">map("code-variable">m => "code-variable">m."code-variable">id)) + 1; } "code-comment">"code-comment">// Load attendance "code-keyword">"code-keyword">const "code-variable">attendanceData = "code-keyword">"code-keyword">await "code-">function">getSheetData("code-variable">SHEETS."code-variable">ATTENDANCE); "code-keyword">"code-keyword">if ("code-variable">attendanceData."code-variable">length > 1) { "code-variable">attendance = "code-variable">attendanceData."code-">function">slice(1)."code-">function">map("code-variable">row => ({ "code-variable">id: "code-">function">parseInt("code-variable">row[0]), "code-variable">memberId: "code-">function">parseInt("code-variable">row[1]), "code-variable">memberName: "code-variable">row[2], "code-variable">date: "code-variable">row[3], "code-variable">serviceType: "code-variable">row[4], "code-variable">status: "code-variable">row[5], "code-variable">timestamp: "code-variable">row[6] })); "code-variable">nextAttendanceId = "code-">function">Math."code-">function">max(..."code-variable">attendance."code-">function">map("code-variable">a => "code-variable">a."code-variable">id)) + 1; } "code-comment">"code-comment">// Load leave applications "code-keyword">"code-keyword">const "code-variable">leaveData = "code-keyword">"code-keyword">await "code-">function">getSheetData("code-variable">SHEETS."code-variable">LEAVE); "code-keyword">"code-keyword">if ("code-variable">leaveData."code-variable">length > 1) { "code-variable">leaveApplications = "code-variable">leaveData."code-">function">slice(1)."code-">function">map("code-variable">row => ({ "code-variable">id: "code-">function">parseInt("code-variable">row[0]), "code-variable">memberId: "code-">function">parseInt("code-variable">row[1]), "code-variable">memberName: "code-variable">row[2], "code-variable">startDate: "code-variable">row[3], "code-variable">endDate: "code-variable">row[4], "code-variable">leaveType: "code-variable">row[5], "code-variable">reason: "code-variable">row[6], "code-variable">status: "code-variable">row[7], "code-variable">applicationDate: "code-variable">row[8], "code-variable">adminComments: "code-variable">row[9], "code-variable">reviewedBy: "code-variable">row[10], "code-variable">reviewDate: "code-variable">row[11] })); "code-variable">nextLeaveId = "code-">function">Math."code-">function">max(..."code-variable">leaveApplications."code-">function">map("code-variable">l => "code-variable">l."code-variable">id)) + 1; } "code-comment">"code-comment">// Load settings "code-keyword">"code-keyword">const "code-variable">settingsData = "code-keyword">"code-keyword">await "code-">function">getSheetData("code-variable">SHEETS."code-variable">SETTINGS); "code-keyword">"code-keyword">if ("code-variable">settingsData."code-variable">length > 1) { "code-variable">settingsData."code-">function">slice(1)."code-">function">forEach("code-variable">row => { "code-keyword">"code-keyword">if ("code-variable">row[0] === "code-string">'adminPassword') "code-variable">settings."code-variable">adminPassword = "code-variable">row[1]; "code-keyword">"code-keyword">if ("code-variable">row[0] === "code-string">'googleSheetUrl') "code-variable">settings."code-variable">googleSheetUrl = "code-variable">row[1]; "code-keyword">"code-keyword">if ("code-variable">row[0] === "code-string">'churchSettings') "code-variable">settings."code-variable">churchSettings = "code-variable">row[1]; }); } "code-comment">"code-comment">// Update UI with loaded data "code-keyword">"code-keyword">if ("code-variable">currentUser && "code-variable">isAdmin) { "code-">function">updateAdminDashboard(); } "code-keyword">"code-keyword">else "code-keyword">"code-keyword">if ("code-variable">currentUser) { "code-">function">updateMemberDashboard(); } } "code-keyword">"code-keyword">catch ("code-variable">"code-function">error) { "code-">function">"code-function">console."code-">function">"code-function">error("code-string">'Error initializing data:', "code-variable">"code-function">error); "code-">function">showMessage("code-string">'Error loading data. Using local storage as fallback.', "code-string">'warning'); "code-">function">loadFromLocalStorage(); } } "code-comment">"code-comment">// Initialize the application "code-">function">document."code-">function">addEventListener("code-string">'DOMContentLoaded', "code-keyword">"code-keyword">function() { "code-">function">document."code-">function">getElementById("code-string">'attendanceDate')."code-variable">valueAsDate = "code-keyword">new "code-">function">Date(); "code-">function">initializeData(); });

        // Base URL for Google Sheets API
        const SHEETS_API = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/`;
        
        // Public API key (restrict this in Google Cloud Console)
        const API_KEY = 'AIzaSyBewL5Cb4Q4OC7eJhszEz2d3JkFQgxmumk';
        
        // Function to get data from Google Sheets
        async function getSheetData(sheetName, range = '') {
            try {
                const response = await fetch(`${SHEETS_API}${sheetName}${range}?key=${API_KEY}`);
                const data = await response.json();
                return data.values || [];
            } catch (error) {
                console.error('Error fetching data:', error);
                showMessage('Error loading data. Please check your connection.', 'error');
                return [];
            }
        }
        
        // Function to append data to Google Sheets
        async function appendToSheet(sheetName, values) {
            try {
                const response = await fetch(`${SHEETS_API}${sheetName}:append?valueInputOption=USER_ENTERED&key=${API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        values: [values]
                    })
                });
                
                const result = await response.json();
                return result;
            } catch (error) {
                console.error('Error appending data:', error);
                showMessage('Error saving data. Please try again.', 'error');
                return null;
            }
        }
        
        // Function to update data in Google Sheets
        async function updateSheet(sheetName, range, values) {
            try {
                const response = await fetch(`${SHEETS_API}${sheetName}!${range}?valueInputOption=USER_ENTERED&key=${API_KEY}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        values: [values]
                    })
                });
                
                const result = await response.json();
                return result;
            } catch (error) {
                console.error('Error updating data:', error);
                showMessage('Error updating data. Please try again.', 'error');
                return null;
            }
        }
        
        // Initialize data from Google Sheets
        async function initializeData() {
            try {
                // Load members
                const membersData = await getSheetData(SHEETS.MEMBERS);
                if (membersData.length > 1) {
                    members = membersData.slice(1).map(row => ({
                        id: parseInt(row[0]),
                        name: row[1],
                        phone: row[2],
                        voicePart: row[3],
                        email: row[4],
                        registeredDate: row[5],
                        status: row[6]
                    }));
                    nextMemberId = Math.max(...members.map(m => m.id)) + 1;
                }
                
                // Load attendance
                const attendanceData = await getSheetData(SHEETS.ATTENDANCE);
                if (attendanceData.length > 1) {
                    attendance = attendanceData.slice(1).map(row => ({
                        id: parseInt(row[0]),
                        memberId: parseInt(row[1]),
                        memberName: row[2],
                        date: row[3],
                        serviceType: row[4],
                        status: row[5],
                        timestamp: row[6]
                    }));
                    nextAttendanceId = Math.max(...attendance.map(a => a.id)) + 1;
                }
                
                // Load leave applications
                const leaveData = await getSheetData(SHEETS.LEAVE);
                if (leaveData.length > 1) {
                    leaveApplications = leaveData.slice(1).map(row => ({
                        id: parseInt(row[0]),
                        memberId: parseInt(row[1]),
                        memberName: row[2],
                        startDate: row[3],
                        endDate: row[4],
                        leaveType: row[5],
                        reason: row[6],
                        status: row[7],
                        applicationDate: row[8],
                        adminComments: row[9],
                        reviewedBy: row[10],
                        reviewDate: row[11]
                    }));
                    nextLeaveId = Math.max(...leaveApplications.map(l => l.id)) + 1;
                }
                
                // Load settings
                const settingsData = await getSheetData(SHEETS.SETTINGS);
                if (settingsData.length > 1) {
                    settingsData.slice(1).forEach(row => {
                        if (row[0] === 'adminPassword') settings.adminPassword = row[1];
                        if (row[0] === 'googleSheetUrl') settings.googleSheetUrl = row[1];
                        if (row[0] === 'churchSettings') settings.churchSettings = row[1];
                    });
                }
                
                // Update UI with loaded data
                if (currentUser && isAdmin) {
                    updateAdminDashboard();
                } else if (currentUser) {
                    updateMemberDashboard();
                }
                
            } catch (error) {
                console.error('Error initializing data:', error);
                showMessage('Error loading data. Using local storage as fallback.', 'warning');
                loadFromLocalStorage();
            }
        }
        
        // Replace the saveToGoogleSheets function with this implementation
        async function saveToGoogleSheets(sheetName, data) {
            try {
                let values = [];
                
                switch(sheetName) {
                    case 'members':
                        values = [
                            data.id,
                            data.name,
                            data.phone,
                            data.voicePart,
                            data.email || '',
                            data.registeredDate,
                            data.status
                        ];
                        await appendToSheet(SHEETS.MEMBERS, values);
                        break;
                        
                    case 'attendance':
                        values = [
                            data.id,
                            data.memberId,
                            data.memberName,
                            data.date,
                            data.serviceType,
                            data.status,
                            data.timestamp
                        ];
                        await appendToSheet(SHEETS.ATTENDANCE, values);
                        break;
                        
                    case 'leave_applications':
                        values = [
                            data.id,
                            data.memberId,
                            data.memberName,
                            data.startDate,
                            data.endDate,
                            data.leaveType,
                            data.reason,
                            data.status,
                            data.applicationDate,
                            data.adminComments || '',
                            data.reviewedBy || '',
                            data.reviewDate || ''
                        ];
                        await appendToSheet(SHEETS.LEAVE, values);
                        break;
                }
                
                // Also save to local storage as backup
                saveToLocalStorage();
                
            } catch (error) {
                console.error('Error saving to Google Sheets:', error);
                showMessage('Could not save to cloud. Using local storage.', 'warning');
                saveToLocalStorage();
            }
        }
        
        // Local storage fallback functions
        function saveToLocalStorage() {
            localStorage.setItem('choirMembers', JSON.stringify(members));
            localStorage.setItem('choirAttendance', JSON.stringify(attendance));
            localStorage.setItem('choirLeaveApplications', JSON.stringify(leaveApplications));
            localStorage.setItem('choirSettings', JSON.stringify(settings));
            localStorage.setItem('choirNextIds', JSON.stringify({
                nextMemberId,
                nextAttendanceId,
                nextLeaveId
            }));
        }
        
        function loadFromLocalStorage() {
            const savedMembers = localStorage.getItem('choirMembers');
            const savedAttendance = localStorage.getItem('choirAttendance');
            const savedLeave = localStorage.getItem('choirLeaveApplications');
            const savedSettings = localStorage.getItem('choirSettings');
            const savedIds = localStorage.getItem('choirNextIds');
            
            if (savedMembers) members = JSON.parse(savedMembers);
            if (savedAttendance) attendance = JSON.parse(savedAttendance);
            if (savedLeave) leaveApplications = JSON.parse(savedLeave);
            if (savedSettings) settings = JSON.parse(savedSettings);
            if (savedIds) {
                const ids = JSON.parse(savedIds);
                nextMemberId = ids.nextMemberId;
                nextAttendanceId = ids.nextAttendanceId;
                nextLeaveId = ids.nextLeaveId;
            }
        }
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('attendanceDate').valueAsDate = new Date();
            initializeData();
        });
        
        // Your existing JavaScript code continues here...
        let members = [ /* ... */ ];
        let attendance = [ /* ... */ ];
        let leaveApplications = [ /* ... */ ];
        let currentUser = null;
        let isAdmin = false;
        let nextMemberId = 5;
        let nextAttendanceId = 3;
        let nextLeaveId = 3;
        let settings = { /* ... */ };
        
        // All your existing functions remain the same
        function showMessage(message, type = 'success') { /* ... */ }
        function loginUser() { /* ... */ }
        // ... etc.
    </script>
   </body>
</html>



